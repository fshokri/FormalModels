<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE nta PUBLIC '-//Uppaal Team//DTD Flat System 1.1//EN' 'http://www.it.uu.se/research/group/darts/uppaal/flat-1_2.dtd'>
<nta>
	<declaration>// Place global declarations here.
//Uppaal does not support enumerated types!!!

// varibles for abstarc model
clock Gclk;
const int N=5;
typedef int [0, N-1] id_t; //process identifier subtype
bool Perm_Given[N];
bool LQ_per[N] ;
bool Lan_per[N] ;
bool Elan_per[N];
bool Emergency_Prog;
bool Runw_asn[N];
bool Runway_busy;
bool Gate_asn[N] ;
typedef int [0, 1] boo;
bool High_Risk [N];

// LR =Landing Request, LRR = Landing Request Rejection, LQ= Landing Queue, LP=  Landing Permission, GG= Give Gate, Emergency Landing Request=ELR, Emergency Landing Permission=ELP, 
// High priority Queue = HPQ, Low priority Queue=LPQ
chan ELR[N],LR[N],LRR[N],LQ[N],GG[N],LP[N],HPQ[N],LPQ[N],ELRR[N], EGG[N],ELR_LQ[N], HPQ_LP[N], LPQ_LP[N];
urgent chan ELP[N],ELR_HPQ[N],ELR_LPQ[N];

// varibles for queue refinement model

id_t HPqueue [id_t];
id_t LPqueue [id_t];
int [0,N] lenH,lenL, counter=0;


const int Max_Queue_Size=4 ;


// varibles for fuel refinement model


const int low =0;
const int medium=1;
const int high=2;
typedef int[0,2] pState;
pState fuel[N]={low,low,low,low,low};
typedef int[1,2] fstate;

</declaration>
	<template>
		<name x="5" y="5">M0_Planes</name>
		<parameter>const id_t id</parameter>
		<declaration>// Place local declarations here.
clock x;</declaration>
		<location id="id0" x="-76" y="-25">
			<name x="-199" y="-35">Leaving_Airport</name>
		</location>
		<location id="id1" x="416" y="102">
			<name x="392" y="110">At_Gate</name>
		</location>
		<location id="id2" x="-76" y="102">
			<name x="-221" y="68">Waiting_EmergLand</name>
			<urgent/>
		</location>
		<location id="id3" x="195" y="102">
			<name x="170" y="110">Landing_Runway</name>
			<urgent/>
		</location>
		<location id="id4" x="187" y="-161">
			<name x="204" y="-187">Landing_Queue</name>
			<label kind="invariant" x="204" y="-170">x&lt;=30</label>
		</location>
		<location id="id5" x="-76" y="-161">
			<name x="-170" y="-153">Waiting_L_Permission</name>
			<urgent/>
		</location>
		<location id="id6" x="-314" y="-161">
			<name x="-331" y="-195">In_Air</name>
			<label kind="invariant" x="-306" y="-153">x&lt;=20</label>
		</location>
		<init ref="id6"/>
		<transition>
			<source ref="id5"/>
			<target ref="id0"/>
			<label kind="guard" x="-187" y="-119">not LQ_per[id] &amp;&amp; 
Perm_Given[id]</label>
			<label kind="assignment" x="-170" y="-76">Perm_Given[id]:=false</label>
		</transition>
		<transition>
			<source ref="id3"/>
			<target ref="id1"/>
			<label kind="guard" x="255" y="144">Gate_asn[id] &amp;&amp;
Runway_busy &amp;&amp;
Lan_per[id]</label>
			<label kind="assignment" x="382" y="136">Gate_asn[id] := false,
Runway_busy:= false,
Lan_per[id]:= false</label>
			<nail x="306" y="127"/>
		</transition>
		<transition>
			<source ref="id3"/>
			<target ref="id1"/>
			<label kind="guard" x="221" y="-8">Gate_asn[id] &amp;&amp;
Runway_busy &amp;&amp;
Elan_per[id] &amp;&amp;
Emergency_Prog</label>
			<label kind="assignment" x="340" y="-8">Gate_asn[id]:= false,
Runway_busy:= false,
Elan_per[id]:= false,
Emergency_Prog:=false</label>
			<nail x="297" y="67"/>
		</transition>
		<transition>
			<source ref="id3"/>
			<target ref="id3"/>
			<label kind="synchronisation" x="119" y="127">GG[id]?</label>
			<nail x="187" y="144"/>
			<nail x="153" y="119"/>
		</transition>
		<transition>
			<source ref="id2"/>
			<target ref="id2"/>
			<label kind="synchronisation" x="-102" y="144">ELP[id]?</label>
			<nail x="-51" y="144"/>
			<nail x="-102" y="144"/>
		</transition>
		<transition>
			<source ref="id4"/>
			<target ref="id4"/>
			<label kind="synchronisation" x="170" y="-221">LP[id]?</label>
			<nail x="211" y="-196"/>
			<nail x="160" y="-196"/>
		</transition>
		<transition>
			<source ref="id5"/>
			<target ref="id5"/>
			<label kind="synchronisation" x="-93" y="-212">LQ[id]?</label>
			<nail x="-102" y="-195"/>
			<nail x="-51" y="-195"/>
		</transition>
		<transition>
			<source ref="id2"/>
			<target ref="id0"/>
			<label kind="guard" x="-178" y="0">Perm_Given[id] &amp;&amp;
not Elan_per[id]</label>
			<label kind="assignment" x="-204" y="34">Perm_Given[id]:= false</label>
		</transition>
		<transition>
			<source ref="id4"/>
			<target ref="id2"/>
			<label kind="guard" x="8" y="-102">not Lan_per[id]</label>
			<label kind="synchronisation" x="0" y="-76">ELR_LQ[id]!</label>
			<label kind="comments" x="-17" y="-25">Send_LQ_Emerg_Req</label>
			<nail x="59" y="-34"/>
		</transition>
		<transition>
			<source ref="id5"/>
			<target ref="id4"/>
			<label kind="guard" x="8" y="-204">Perm_Given[id] &amp;&amp;
LQ_per[id]</label>
			<label kind="assignment" x="-8" y="-161">Perm_Given[id]:=false,
x:=0</label>
		</transition>
		<transition>
			<source ref="id6"/>
			<target ref="id2"/>
			<label kind="synchronisation" x="-255" y="-51">ELR[id]!</label>
			<label kind="comments" x="-296" y="127">Send_L_Emerg_Req</label>
			<nail x="-314" y="102"/>
		</transition>
		<transition>
			<source ref="id2"/>
			<target ref="id3"/>
			<label kind="guard" x="8" y="25">Perm_Given[id] &amp;&amp;
Runway_busy &amp;&amp;
Elan_per[id] &amp;&amp;
Emergency_Prog</label>
			<label kind="assignment" x="-34" y="110">Perm_Given[id]:=false</label>
			<label kind="comments" x="-25" y="136">Emergency_Landing</label>
			<nail x="-51" y="102"/>
		</transition>
		<transition>
			<source ref="id4"/>
			<target ref="id3"/>
			<label kind="guard" x="195" y="-119">Runway_busy &amp;&amp;
Lan_per[id]</label>
			<label kind="assignment" x="187" y="-85">LQ_per[id]:=false</label>
			<label kind="comments" x="204" y="-51">Landing</label>
		</transition>
		<transition>
			<source ref="id6"/>
			<target ref="id5"/>
			<label kind="synchronisation" x="-204" y="-178">LR[id]!</label>
			<label kind="comments" x="-255" y="-204">Send_L_request</label>
		</transition>
	</template>
	<template>
		<name>M0_Controller</name>
		<declaration>
</declaration>
		<location id="id7" x="-17592" y="-4272">
		</location>
		<init ref="id7"/>
		<transition>
			<source ref="id7"/>
			<target ref="id7"/>
			<label kind="select" x="-17569" y="-4309">p:id_t</label>
			<label kind="synchronisation" x="-17535" y="-4326">ELR_LQ[p]?</label>
			<nail x="-17561" y="-4335"/>
			<nail x="-17527" y="-4292"/>
		</transition>
		<transition>
			<source ref="id7"/>
			<target ref="id7"/>
			<label kind="select" x="-17620" y="-4335">p:id_t</label>
			<label kind="synchronisation" x="-17629" y="-4360">LR[p]?</label>
			<nail x="-17578" y="-4343"/>
			<nail x="-17637" y="-4335"/>
		</transition>
		<transition>
			<source ref="id7"/>
			<target ref="id7"/>
			<label kind="select" x="-17578" y="-4250">p:id_t,
bb:boo</label>
			<label kind="guard" x="-17595" y="-4199">not Runway_busy &amp;&amp;
not Elan_per[p] &amp;&amp;
not Perm_Given[p] &amp;&amp;
not(bb==Emergency_Prog)</label>
			<label kind="synchronisation" x="-17569" y="-4216">ELP[p]!</label>
			<label kind="assignment" x="-17595" y="-4122">Elan_per[p]:= bb,
Perm_Given[p]:=true,
Emergency_Prog:= true,
Runway_busy:= true</label>
			<nail x="-17578" y="-4207"/>
			<nail x="-17535" y="-4233"/>
		</transition>
		<transition>
			<source ref="id7"/>
			<target ref="id7"/>
			<label kind="select" x="-17663" y="-4267">p:id_t</label>
			<label kind="guard" x="-17841" y="-4292">not Runway_busy &amp;&amp;
not Lan_per[p] &amp;&amp;
not Emergency_Prog</label>
			<label kind="synchronisation" x="-17714" y="-4275">LP[p]!</label>
			<label kind="assignment" x="-17824" y="-4241">Lan_per[p]:= true,
Runway_busy:= true</label>
			<nail x="-17654" y="-4224"/>
			<nail x="-17671" y="-4267"/>
			<nail x="-17663" y="-4267"/>
		</transition>
		<transition>
			<source ref="id7"/>
			<target ref="id7"/>
			<label kind="select" x="-17663" y="-4309">p:id_t,
bb:boo</label>
			<label kind="guard" x="-17824" y="-4386">not Perm_Given[p] &amp;&amp;
Emergency_Prog 
imply bb== false</label>
			<label kind="synchronisation" x="-17697" y="-4326">LQ[p]!</label>
			<label kind="assignment" x="-17841" y="-4335">Perm_Given[p]:= true,
LQ_per[p]:=bb</label>
			<nail x="-17671" y="-4275"/>
			<nail x="-17646" y="-4326"/>
			<nail x="-17637" y="-4318"/>
		</transition>
		<transition>
			<source ref="id7"/>
			<target ref="id7"/>
			<label kind="select" x="-17561" y="-4275">p:id_t</label>
			<label kind="synchronisation" x="-17518" y="-4267">ELR[p]?</label>
			<nail x="-17527" y="-4241"/>
			<nail x="-17518" y="-4275"/>
		</transition>
		<transition>
			<source ref="id7"/>
			<target ref="id7"/>
			<label kind="select" x="-17629" y="-4241">p:id_t</label>
			<label kind="guard" x="-17731" y="-4199">not Gate_asn[p] &amp;&amp;  
Runway_busy</label>
			<label kind="synchronisation" x="-17671" y="-4224">GG[p]!</label>
			<label kind="assignment" x="-17731" y="-4165">Gate_asn[p]:= true</label>
			<nail x="-17637" y="-4224"/>
			<nail x="-17595" y="-4199"/>
		</transition>
	</template>
	<template>
		<name x="5" y="5">M1_Planes</name>
		<parameter>const id_t id</parameter>
		<declaration>// Place local declarations here.
clock x;
  
void enHPqueue(id_t element)
{
   HPqueue [lenH++]=element;
 }

 void enLPqueue(id_t element)
 {
   LPqueue [lenL++]=element;
  }

void deHPqueue()
{
        int i = 0;
        lenH -= 1;
        while (i &lt; lenH)
        {
                HPqueue[i] = HPqueue[i + 1];
                i++;
        }
        HPqueue[i] = 0;
}
void deLPqueue()
{
        int i = 0;
        lenL -= 1;
        while (i &lt; lenL)
        {
                LPqueue[i] = LPqueue[i + 1];
                i++;
        }
        LPqueue[i] = 0;
}
//++++++++++++++++++++++++++++++++++++++++++++++++++++++++
void deHPqueue_Em(id_t element, int i)   // dequeue happens when plane send emergancy landing while it is in queue but we dont know the position of queue ### ELR_HPQ ###
{
       
         HPqueue[i] = HPqueue[i + 1];
         i++;
         HPqueue[i] = 0;
}

void deLPqueue_Em(id_t element, int i)  //  dequeue happens when plane send emergancy landing while it is in queue but we dont know the position of queue ### ELR_LPQ ###
{
       
         HPqueue[i] = HPqueue[i + 1];
         i++;
         HPqueue[i] = 0;
}



</declaration>
		<location id="id8" x="272" y="-256">
			<name x="248" y="-288">High_PQ</name>
			<label kind="invariant" x="248" y="-248">x&lt;=20</label>
		</location>
		<location id="id9" x="-64" y="-32">
			<name x="-120" y="-64">Leaving_Airport</name>
		</location>
		<location id="id10" x="784" y="80">
			<name x="800" y="72">At_Gate</name>
			<label kind="invariant" x="774" y="95">x&lt;=20</label>
		</location>
		<location id="id11" x="-64" y="96">
			<name x="-104" y="64">Waiting_EmergLand</name>
			<label kind="invariant" x="-74" y="111">x&lt;=10</label>
			<urgent/>
		</location>
		<location id="id12" x="456" y="40">
			<name x="424" y="8">Landing_Runway</name>
			<label kind="invariant" x="446" y="55">x&lt;=10</label>
			<urgent/>
		</location>
		<location id="id13" x="272" y="-160">
			<name x="240" y="-200">Low_PQ</name>
			<label kind="invariant" x="256" y="-152">x&lt;=30</label>
		</location>
		<location id="id14" x="-64" y="-160">
			<name x="-221" y="-187">Waiting_L_Permission</name>
			<label kind="invariant" x="-74" y="-145">x&lt;=10</label>
			<urgent/>
		</location>
		<location id="id15" x="-264" y="-160">
			<name x="-298" y="-198">In_Air</name>
			<label kind="invariant" x="-280" y="-152">x&lt;=10</label>
		</location>
		<init ref="id15"/>
		<transition>
			<source ref="id13"/>
			<target ref="id13"/>
			<label kind="synchronisation" x="360" y="-200">LPQ_LP[id]?</label>
			<nail x="384" y="-160"/>
			<nail x="368" y="-208"/>
			<nail x="368" y="-208"/>
		</transition>
		<transition>
			<source ref="id8"/>
			<target ref="id8"/>
			<label kind="synchronisation" x="320" y="-368">HPQ_LP[id]?</label>
			<nail x="352" y="-328"/>
			<nail x="328" y="-344"/>
			<nail x="304" y="-352"/>
		</transition>
		<transition>
			<source ref="id8"/>
			<target ref="id12"/>
			<label kind="guard" x="472" y="-272">Runway_busy== true &amp;&amp;
Lan_per[id]== true</label>
			<label kind="assignment" x="488" y="-208">LQ_per[id]:=false,
x:=0</label>
			<label kind="comments" x="467" y="-144">Landing</label>
			<nail x="368" y="-304"/>
			<nail x="456" y="-304"/>
			<nail x="456" y="-56"/>
			<nail x="456" y="-48"/>
		</transition>
		<transition>
			<source ref="id14"/>
			<target ref="id13"/>
			<label kind="guard" x="48" y="-208">LQ_per[id] &amp;&amp; Perm_Given[id]
&amp;&amp; High_Risk[id]==false</label>
			<label kind="synchronisation" x="8" y="-176">LPQ[id]?</label>
			<label kind="assignment" x="56" y="-160">Perm_Given[id]:=false ,
x:=0</label>
			<nail x="88" y="-160"/>
			<nail x="208" y="-160"/>
		</transition>
		<transition>
			<source ref="id8"/>
			<target ref="id11"/>
			<label kind="guard" x="-424" y="-280">Lan_per[id]== false</label>
			<label kind="synchronisation" x="-408" y="-184">ELR_HPQ[id]!</label>
			<label kind="assignment" x="-416" y="-240">x:=0</label>
			<label kind="comments" x="-178" y="-365">Send_HighPQ_Emerg_Req</label>
			<nail x="272" y="-336"/>
			<nail x="272" y="-336"/>
			<nail x="-240" y="-336"/>
			<nail x="-312" y="-336"/>
			<nail x="-312" y="-336"/>
			<nail x="-312" y="112"/>
			<nail x="-312" y="112"/>
			<nail x="-136" y="112"/>
			<nail x="-88" y="112"/>
		</transition>
		<transition>
			<source ref="id14"/>
			<target ref="id8"/>
			<label kind="guard" x="40" y="-320">LQ_per[id] &amp;&amp;Perm_Given[id]
&amp;&amp; High_Risk[id]== true</label>
			<label kind="synchronisation" x="-8" y="-264">HPQ[id]?</label>
			<label kind="assignment" x="56" y="-288">Perm_Given[id]:=false,
x:=0</label>
			<nail x="56" y="-256"/>
			<nail x="88" y="-256"/>
			<nail x="256" y="-256"/>
		</transition>
		<transition>
			<source ref="id14"/>
			<target ref="id9"/>
			<label kind="guard" x="-124" y="-126">LQ_per[id] == false &amp;&amp; 
Perm_Given[id]</label>
			<label kind="assignment" x="-124" y="-96">Lan_per[id] := false , 
Perm_Given[id]:= false</label>
		</transition>
		<transition>
			<source ref="id12"/>
			<target ref="id10"/>
			<label kind="guard" x="504" y="-72">Gate_asn[id] == true &amp;&amp;
Runway_busy== true&amp;&amp;
Lan_per[id]== true</label>
			<label kind="assignment" x="672" y="-72">Gate_asn[id] := false,
Runway_busy:= false,
Lan_per[id]:= false,
x:=0</label>
			<nail x="472" y="-8"/>
			<nail x="784" y="-8"/>
		</transition>
		<transition>
			<source ref="id12"/>
			<target ref="id10"/>
			<label kind="guard" x="464" y="96">Gate_asn[id] == true &amp;&amp;
Runway_busy== true&amp;&amp;
Elan_per[id]== true &amp;&amp;
Emergency_Prog== true</label>
			<label kind="assignment" x="640" y="96">Gate_asn[id]:= false,
Runway_busy:= false,
Elan_per[id]:= false,
Emergency_Prog:=false,
x:=0</label>
			<nail x="456" y="56"/>
			<nail x="456" y="80"/>
			<nail x="456" y="80"/>
			<nail x="512" y="80"/>
		</transition>
		<transition>
			<source ref="id12"/>
			<target ref="id12"/>
			<label kind="synchronisation" x="376" y="32">GG[id]?</label>
			<nail x="376" y="-8"/>
			<nail x="376" y="72"/>
		</transition>
		<transition>
			<source ref="id11"/>
			<target ref="id11"/>
			<label kind="synchronisation" x="-88" y="152">ELP[id]?</label>
			<nail x="-16" y="144"/>
			<nail x="-104" y="144"/>
		</transition>
		<transition>
			<source ref="id14"/>
			<target ref="id14"/>
			<label kind="guard" x="-144" y="-280">Perm_Given[id]==false</label>
			<label kind="synchronisation" x="-88" y="-256">LQ[id]?</label>
			<label kind="assignment" x="-80" y="-224">x:=0</label>
			<nail x="-120" y="-232"/>
			<nail x="-8" y="-232"/>
		</transition>
		<transition>
			<source ref="id11"/>
			<target ref="id9"/>
			<label kind="guard" x="-124" y="-10">Perm_Given[id]&amp;&amp;
Elan_per[id]== false</label>
			<label kind="assignment" x="-124" y="20">Perm_Given[id]:= false,
Elan_per[id]:= false</label>
		</transition>
		<transition>
			<source ref="id13"/>
			<target ref="id11"/>
			<label kind="guard" x="74" y="-80">Lan_per[id]== false</label>
			<label kind="synchronisation" x="102" y="-98">ELR_LPQ[id]!</label>
			<label kind="assignment" x="85" y="-59">x:=0</label>
			<label kind="comments" x="42" y="-17">Send_LowPQ_Emerg_Req</label>
		</transition>
		<transition>
			<source ref="id15"/>
			<target ref="id11"/>
			<label kind="synchronisation" x="-256" y="-8">ELR[id]!</label>
			<label kind="comments" x="-255" y="68">Send_L_Emerg_Req</label>
			<nail x="-264" y="-112"/>
			<nail x="-264" y="96"/>
			<nail x="-104" y="96"/>
		</transition>
		<transition>
			<source ref="id11"/>
			<target ref="id12"/>
			<label kind="guard" x="8" y="93">Perm_Given[id]== true &amp;&amp;
Runway_busy== true &amp;&amp;
Elan_per[id]== true &amp;&amp;
Emergency_Prog== true</label>
			<label kind="assignment" x="216" y="96">x:=0,
Perm_Given[id]:=false</label>
			<label kind="comments" x="136" y="51">Emergency_Landing</label>
			<nail x="-48" y="80"/>
			<nail x="144" y="80"/>
			<nail x="208" y="80"/>
			<nail x="248" y="80"/>
			<nail x="336" y="80"/>
			<nail x="440" y="80"/>
		</transition>
		<transition>
			<source ref="id13"/>
			<target ref="id12"/>
			<label kind="guard" x="248" y="-128">Runway_busy== false &amp;&amp;
Lan_per[id]== true</label>
			<label kind="assignment" x="296" y="-80">LQ_per[id]:=false,
Runway_busy:= true,
x:=0</label>
			<label kind="comments" x="304" y="-30">Landing</label>
		</transition>
		<transition>
			<source ref="id15"/>
			<target ref="id14"/>
			<label kind="select" x="-187" y="-204">br:boo</label>
			<label kind="synchronisation" x="-176" y="-160">LR[id]!</label>
			<label kind="assignment" x="-216" y="-144">High_Risk[id]:=br,
x:=0</label>
			<label kind="comments" x="-229" y="-221">Send_L_request</label>
		</transition>
	</template>
	<template>
		<name>M1_Controller</name>
		<location id="id16" x="-17608" y="-4272">
		</location>
		<init ref="id16"/>
		<transition>
			<source ref="id16"/>
			<target ref="id16"/>
			<label kind="select" x="-17504" y="-4200">p:id_t</label>
			<label kind="synchronisation" x="-17448" y="-4176">ELR[p]?</label>
			<nail x="-17480" y="-4216"/>
			<nail x="-17464" y="-4208"/>
			<nail x="-17448" y="-4200"/>
			<nail x="-17488" y="-4152"/>
			<nail x="-17600" y="-4264"/>
			<nail x="-17600" y="-4264"/>
		</transition>
		<transition>
			<source ref="id16"/>
			<target ref="id16"/>
			<label kind="select" x="-17768" y="-4304">p:id_t</label>
			<label kind="guard" x="-18072" y="-4320">Runway_busy== false &amp;&amp;
Lan_per[p]== false &amp;&amp;
Emergency_Prog==false</label>
			<label kind="synchronisation" x="-17848" y="-4272">HPQ_LP[p]!</label>
			<label kind="assignment" x="-18232" y="-4312">Runway_busy:= true,
Lan_per[p]:= true</label>
			<nail x="-17760" y="-4240"/>
			<nail x="-17760" y="-4312"/>
		</transition>
		<transition>
			<source ref="id16"/>
			<target ref="id16"/>
			<label kind="select" x="-17720" y="-4208">p:id_t</label>
			<label kind="guard" x="-18000" y="-4192">Runway_busy== false &amp;&amp;
Lan_per[p]== false &amp;&amp;
Emergency_Prog==false</label>
			<label kind="synchronisation" x="-17808" y="-4184">LPQ_LP[p]!</label>
			<label kind="assignment" x="-18208" y="-4184">Runway_busy:= true,
Lan_per[p]:= true</label>
			<nail x="-17704" y="-4160"/>
			<nail x="-17752" y="-4216"/>
		</transition>
		<transition>
			<source ref="id16"/>
			<target ref="id16"/>
			<label kind="select" x="-17632" y="-4400">p:id_t</label>
			<label kind="synchronisation" x="-17640" y="-4432">LR[p]?</label>
			<nail x="-17552" y="-4408"/>
			<nail x="-17656" y="-4400"/>
		</transition>
		<transition>
			<source ref="id16"/>
			<target ref="id16"/>
			<label kind="select" x="-17576" y="-4176">p:id_t,
bb:boo</label>
			<label kind="guard" x="-17528" y="-4096">Runway_busy== false &amp;&amp;
Elan_per[p]== false &amp;&amp;
Perm_Given[p]== false &amp;&amp;
not(bb==Emergency_Prog)</label>
			<label kind="synchronisation" x="-17536" y="-4128">ELP[p]!</label>
			<label kind="assignment" x="-17510" y="-4020">Elan_per[p]:= bb,
Perm_Given[p]:=true,
Emergency_Prog:= true,
Runway_busy:= true</label>
			<nail x="-17584" y="-4120"/>
			<nail x="-17512" y="-4144"/>
			<nail x="-17520" y="-4160"/>
		</transition>
		<transition>
			<source ref="id16"/>
			<target ref="id16"/>
			<label kind="select" x="-17724" y="-4365">p:id_t,
bb:boo</label>
			<label kind="guard" x="-18062" y="-4428">not Perm_Given[p] &amp;&amp;
Emergency_Prog 
imply bb== false</label>
			<label kind="synchronisation" x="-17764" y="-4397">LQ[p]!</label>
			<label kind="assignment" x="-17896" y="-4416">Perm_Given[p]:= true,
LQ_per[p]:=bb</label>
			<nail x="-17704" y="-4320"/>
			<nail x="-17752" y="-4344"/>
			<nail x="-17680" y="-4400"/>
			<nail x="-17632" y="-4312"/>
		</transition>
		<transition>
			<source ref="id16"/>
			<target ref="id16"/>
			<label kind="select" x="-17520" y="-4352">p:id_t</label>
			<label kind="synchronisation" x="-17456" y="-4368">ELR_HPQ[p]?</label>
			<nail x="-17456" y="-4312"/>
			<nail x="-17512" y="-4392"/>
			<nail x="-17560" y="-4328"/>
		</transition>
		<transition>
			<source ref="id16"/>
			<target ref="id16"/>
			<label kind="select" x="-17496" y="-4280">p:id_t</label>
			<label kind="synchronisation" x="-17424" y="-4264">ELR_LPQ[p]?</label>
			<nail x="-17464" y="-4224"/>
			<nail x="-17448" y="-4224"/>
			<nail x="-17448" y="-4296"/>
		</transition>
		<transition>
			<source ref="id16"/>
			<target ref="id16"/>
			<label kind="select" x="-17656" y="-4160">p:id_t</label>
			<label kind="guard" x="-17752" y="-4112">Gate_asn[p] == false &amp;&amp;
Runway_busy== true</label>
			<label kind="synchronisation" x="-17672" y="-4128">GG[p]!</label>
			<label kind="assignment" x="-17736" y="-4072">Gate_asn[p]:= true</label>
			<nail x="-17688" y="-4144"/>
			<nail x="-17608" y="-4128"/>
		</transition>
	</template>
	<template>
		<name x="5" y="5">M2_Planes</name>
		<parameter>const id_t id</parameter>
		<declaration>// Place local declarations here.
clock x;

    
void enHPqueue(id_t element)
{
   HPqueue [lenH++]=element;
 }

 void enLPqueue(id_t element)
 {
   LPqueue [lenL++]=element;
  }
//++++++++++++++++++++++++++++++++++++++++++++++++++++++++
void deHPqueue()   // normal dequeue happens from High priority Queue
{
        int i = 0;
        --lenH;
        while (i &lt; lenH)
        {
                HPqueue[i] = HPqueue[i + 1];
                i++;
        }
        HPqueue[i] = 0;
}
void deLPqueue()    // normal dequeue happens from Low priority Queue
{
        int i = 0;
        --lenL;
        while (i &lt; lenL)
        {
                LPqueue[i] = LPqueue[i + 1];
                i++;
        }
        LPqueue[i] = 0;
}


 //    ***********************   High Priority Queue  removing element in emergancy situation******************


id_t Em_deHPqu_idx(id_t plane )   // dequeue happens when plane send emergancy landing while it is in queue, we want to know its position in the queue ### ELR_HPQ ###
{       
        int i=0;

      while (HPqueue[i] != plane)
  {
        i++;
       
   }
    return i;
   }


void Em_deHPqueue(id_t i )   // dequeue happens when plane send emergancy landing while it is in queue we remove the plane based on its position in the queue ### ELR_HPQ ###
{       
    
        --lenH;
        while (i &lt; lenH)
        {
                HPqueue[i] = HPqueue[i + 1];
                i++;
        }
        HPqueue[i] = 0;
}
   
//    ***********************   Low Priority Queue  removing element in emergancy situation******************


id_t Em_deLPqu_idx(id_t plane )   // dequeue happens when plane send emergancy landing while it is in queue but we want to know its position in the queue ### ELR_HPQ ###
{       
     int i=0;

      while (LPqueue[i] != plane)
  {
         i++;
   }
    return i;
   }

void Em_deLPqueue(id_t i)  //  dequeue happens when plane send emergancy landing while it is in queue we remove the plane based on its position in the queue ### ELR_LPQ ###
{
   
       --lenL;
        while (i &lt; lenL)
       
        {
                LPqueue[i] = LPqueue[i + 1];
                i++;
                
        }
        LPqueue[i] = 0;
} 







</declaration>
		<location id="id17" x="272" y="-256">
			<name x="248" y="-288">High_PQ</name>
			<label kind="invariant" x="248" y="-248">x&lt;=20</label>
			<urgent/>
		</location>
		<location id="id18" x="-64" y="-32">
			<name x="-120" y="-64">Leaving_Airport</name>
		</location>
		<location id="id19" x="784" y="80">
			<name x="800" y="72">At_Gate</name>
			<label kind="invariant" x="774" y="95">x&lt;=20</label>
		</location>
		<location id="id20" x="-64" y="96">
			<name x="-104" y="64">Waiting_EmergLand</name>
			<label kind="invariant" x="-74" y="111">x&lt;=10</label>
			<urgent/>
		</location>
		<location id="id21" x="456" y="40">
			<name x="424" y="8">Landing_Runway</name>
			<label kind="invariant" x="446" y="55">x&lt;=10</label>
			<urgent/>
		</location>
		<location id="id22" x="272" y="-160">
			<name x="240" y="-200">Low_PQ</name>
			<label kind="invariant" x="256" y="-152">x&lt;=30</label>
			<urgent/>
		</location>
		<location id="id23" x="-64" y="-160">
			<name x="-221" y="-187">Waiting_L_Permission</name>
			<label kind="invariant" x="-74" y="-145">x&lt;=10</label>
			<urgent/>
		</location>
		<location id="id24" x="-264" y="-160">
			<name x="-298" y="-198">In_Air</name>
			<label kind="invariant" x="-280" y="-152">x&lt;=10</label>
		</location>
		<init ref="id24"/>
		<transition>
			<source ref="id22"/>
			<target ref="id22"/>
			<label kind="synchronisation" x="360" y="-200">LPQ_LP[id]?</label>
			<nail x="384" y="-160"/>
			<nail x="368" y="-208"/>
			<nail x="368" y="-208"/>
		</transition>
		<transition>
			<source ref="id17"/>
			<target ref="id17"/>
			<label kind="synchronisation" x="320" y="-368">HPQ_LP[id]?</label>
			<nail x="352" y="-328"/>
			<nail x="328" y="-344"/>
			<nail x="304" y="-352"/>
		</transition>
		<transition>
			<source ref="id17"/>
			<target ref="id21"/>
			<label kind="guard" x="472" y="-272">Runway_busy== true &amp;&amp;
Lan_per[id]== true</label>
			<label kind="assignment" x="488" y="-208">LQ_per[id]:=false,
deHPqueue(),
x:=0</label>
			<nail x="368" y="-304"/>
			<nail x="456" y="-304"/>
			<nail x="456" y="-56"/>
			<nail x="456" y="-48"/>
		</transition>
		<transition>
			<source ref="id23"/>
			<target ref="id22"/>
			<label kind="guard" x="48" y="-208">LQ_per[id] &amp;&amp; Perm_Given[id]
&amp;&amp; High_Risk[id]==false</label>
			<label kind="synchronisation" x="8" y="-176">LPQ[id]?</label>
			<label kind="assignment" x="56" y="-160">Perm_Given[id]:=false ,
enLPqueue(id),
x:=0</label>
			<nail x="88" y="-160"/>
			<nail x="208" y="-160"/>
		</transition>
		<transition>
			<source ref="id17"/>
			<target ref="id20"/>
			<label kind="select" x="-214" y="-404">HP_index:id_t</label>
			<label kind="guard" x="-102" y="-408">Lan_per[id]== false &amp;&amp;
HP_index==Em_deHPqu_idx(id)</label>
			<label kind="synchronisation" x="127" y="-382">ELR_HPQ[id]!</label>
			<label kind="assignment" x="-161" y="-348">Em_deHPqueue(HP_index),x:=0</label>
			<nail x="280" y="-353"/>
			<nail x="280" y="-353"/>
			<nail x="-232" y="-353"/>
			<nail x="-304" y="-353"/>
			<nail x="-304" y="-353"/>
			<nail x="-304" y="95"/>
			<nail x="-304" y="95"/>
			<nail x="-128" y="95"/>
			<nail x="-80" y="95"/>
		</transition>
		<transition>
			<source ref="id23"/>
			<target ref="id17"/>
			<label kind="guard" x="25" y="-331">LQ_per[id] &amp;&amp;Perm_Given[id]
&amp;&amp; High_Risk[id]== true</label>
			<label kind="synchronisation" x="-8" y="-264">HPQ[id]?</label>
			<label kind="assignment" x="56" y="-288">Perm_Given[id]:=false ,
enHPqueue(id),
x:=0</label>
			<nail x="34" y="-246"/>
			<nail x="88" y="-256"/>
			<nail x="256" y="-256"/>
		</transition>
		<transition>
			<source ref="id23"/>
			<target ref="id18"/>
			<label kind="guard" x="-124" y="-126">LQ_per[id] == false &amp;&amp; 
Perm_Given[id]</label>
			<label kind="assignment" x="-124" y="-96">Lan_per[id] := false , 
Perm_Given[id]:= false</label>
		</transition>
		<transition>
			<source ref="id21"/>
			<target ref="id19"/>
			<label kind="guard" x="504" y="-72">Gate_asn[id] == true &amp;&amp;
Runway_busy== true&amp;&amp;
Lan_per[id]== true</label>
			<label kind="assignment" x="672" y="-72">Gate_asn[id] := false,
Runway_busy:= false,
Lan_per[id]:= false,
x:=0</label>
			<nail x="472" y="-8"/>
			<nail x="784" y="-8"/>
		</transition>
		<transition>
			<source ref="id21"/>
			<target ref="id19"/>
			<label kind="guard" x="464" y="96">Gate_asn[id] == true &amp;&amp;
Runway_busy== true&amp;&amp;
Elan_per[id]== true &amp;&amp;
Emergency_Prog== true</label>
			<label kind="assignment" x="640" y="96">Gate_asn[id]:= false,
Runway_busy:= false,
Elan_per[id]:= false,
Emergency_Prog:=false,
x:=0</label>
			<nail x="456" y="56"/>
			<nail x="456" y="80"/>
			<nail x="456" y="80"/>
			<nail x="512" y="80"/>
		</transition>
		<transition>
			<source ref="id21"/>
			<target ref="id21"/>
			<label kind="synchronisation" x="376" y="32">GG[id]?</label>
			<nail x="376" y="-8"/>
			<nail x="376" y="72"/>
		</transition>
		<transition>
			<source ref="id20"/>
			<target ref="id20"/>
			<label kind="synchronisation" x="-88" y="152">ELP[id]?</label>
			<nail x="-16" y="144"/>
			<nail x="-104" y="144"/>
		</transition>
		<transition>
			<source ref="id23"/>
			<target ref="id23"/>
			<label kind="synchronisation" x="-88" y="-256">LQ[id]?</label>
			<label kind="assignment" x="-80" y="-224">x:=0</label>
			<nail x="-120" y="-232"/>
			<nail x="-8" y="-232"/>
		</transition>
		<transition>
			<source ref="id20"/>
			<target ref="id18"/>
			<label kind="guard" x="-124" y="-10">Perm_Given[id]&amp;&amp;
Elan_per[id]== false</label>
			<label kind="assignment" x="-124" y="20">Perm_Given[id]:= false,
Elan_per[id]:= false</label>
		</transition>
		<transition>
			<source ref="id22"/>
			<target ref="id20"/>
			<label kind="select" x="-46" y="-83">LP_index:id_t</label>
			<label kind="guard" x="44" y="-62">Lan_per[id]== false &amp;&amp;
LP_index==Em_deLPqu_idx(id)</label>
			<label kind="synchronisation" x="72" y="-80">ELR_LPQ[id]!</label>
			<label kind="assignment" x="72" y="-16">Em_deLPqueue(LP_index),x:=0</label>
		</transition>
		<transition>
			<source ref="id24"/>
			<target ref="id20"/>
			<label kind="synchronisation" x="-256" y="-8">ELR[id]!</label>
			<label kind="comments" x="-255" y="68">Send_L_Emerg_Req</label>
			<nail x="-264" y="-112"/>
			<nail x="-264" y="96"/>
			<nail x="-104" y="96"/>
		</transition>
		<transition>
			<source ref="id20"/>
			<target ref="id21"/>
			<label kind="guard" x="32" y="88">Perm_Given[id]== true &amp;&amp;
Runway_busy== true &amp;&amp;
Elan_per[id]== true &amp;&amp;
Emergency_Prog== true</label>
			<label kind="assignment" x="216" y="96">x:=0,
Perm_Given[id]:=false</label>
			<label kind="comments" x="136" y="98">Emergency_Landing</label>
			<nail x="-48" y="80"/>
			<nail x="144" y="80"/>
			<nail x="208" y="80"/>
			<nail x="248" y="80"/>
			<nail x="336" y="80"/>
			<nail x="440" y="80"/>
		</transition>
		<transition>
			<source ref="id22"/>
			<target ref="id21"/>
			<label kind="guard" x="248" y="-128">Runway_busy== false &amp;&amp;
Lan_per[id]== true</label>
			<label kind="assignment" x="296" y="-80">LQ_per[id]:=false,
Runway_busy:= true,
deLPqueue(),
x:=0</label>
			<label kind="comments" x="304" y="-30">Landing</label>
		</transition>
		<transition>
			<source ref="id24"/>
			<target ref="id23"/>
			<label kind="select" x="-187" y="-204">br:boo</label>
			<label kind="synchronisation" x="-176" y="-160">LR[id]!</label>
			<label kind="assignment" x="-216" y="-144">High_Risk[id]:=br,
x:=0</label>
			<label kind="comments" x="-229" y="-221">Send_L_request</label>
		</transition>
	</template>
	<template>
		<name>M2_Controller</name>
		<location id="id25" x="-47277" y="-47164">
		</location>
		<init ref="id25"/>
		<transition>
			<source ref="id25"/>
			<target ref="id25"/>
			<label kind="select" x="-47173" y="-47092">p:id_t</label>
			<label kind="synchronisation" x="-47117" y="-47068">ELR[p]?</label>
			<nail x="-47149" y="-47108"/>
			<nail x="-47133" y="-47100"/>
			<nail x="-47117" y="-47092"/>
			<nail x="-47157" y="-47044"/>
			<nail x="-47269" y="-47156"/>
			<nail x="-47269" y="-47156"/>
		</transition>
		<transition>
			<source ref="id25"/>
			<target ref="id25"/>
			<label kind="select" x="-47437" y="-47196">p:id_t</label>
			<label kind="guard" x="-47741" y="-47212">Runway_busy== false &amp;&amp;
Lan_per[p]== false &amp;&amp;
Emergency_Prog==false &amp;&amp; 
(counter&lt;=3 or lenL==0)</label>
			<label kind="synchronisation" x="-47517" y="-47164">HPQ_LP[p]!</label>
			<label kind="assignment" x="-47901" y="-47204">Runway_busy:= true,
Lan_per[p]:= true,
counter++</label>
			<nail x="-47429" y="-47132"/>
			<nail x="-47429" y="-47204"/>
		</transition>
		<transition>
			<source ref="id25"/>
			<target ref="id25"/>
			<label kind="select" x="-47389" y="-47100">p:id_t</label>
			<label kind="guard" x="-47669" y="-47084">Runway_busy== false &amp;&amp;
Lan_per[p]== false &amp;&amp;
Emergency_Prog==false&amp;&amp; 
(counter&gt;=3 or lenH==0)</label>
			<label kind="synchronisation" x="-47477" y="-47076">LPQ_LP[p]!</label>
			<label kind="assignment" x="-47877" y="-47076">Runway_busy:= true,
Lan_per[p]:= true,
counter:=0</label>
			<nail x="-47373" y="-47052"/>
			<nail x="-47421" y="-47108"/>
		</transition>
		<transition>
			<source ref="id25"/>
			<target ref="id25"/>
			<label kind="select" x="-47301" y="-47292">p:id_t</label>
			<label kind="synchronisation" x="-47309" y="-47324">LR[p]?</label>
			<nail x="-47221" y="-47300"/>
			<nail x="-47325" y="-47292"/>
		</transition>
		<transition>
			<source ref="id25"/>
			<target ref="id25"/>
			<label kind="select" x="-47245" y="-47068">p:id_t,
bb:boo</label>
			<label kind="guard" x="-47197" y="-46988">Runway_busy== false &amp;&amp;
Elan_per[p]== false &amp;&amp;
Perm_Given[p]== false &amp;&amp;
not(bb==Emergency_Prog)</label>
			<label kind="synchronisation" x="-47205" y="-47020">ELP[p]!</label>
			<label kind="assignment" x="-47181" y="-46924">Elan_per[p]:= bb,
Perm_Given[p]:=true,
Emergency_Prog:= true,
Runway_busy:= true</label>
			<nail x="-47253" y="-47012"/>
			<nail x="-47181" y="-47036"/>
			<nail x="-47189" y="-47052"/>
		</transition>
		<transition>
			<source ref="id25"/>
			<target ref="id25"/>
			<label kind="select" x="-47393" y="-47257">p:id_t,
bb:boo</label>
			<label kind="guard" x="-47965" y="-47396">Perm_Given[p]== false &amp;&amp;
(Emergency_Prog == true imply bb== false) &amp;&amp; (((lenH &gt;= Max_Queue_Size and High_Risk[p]==true)
or (lenL &gt;= Max_Queue_Size and High_Risk[p]== false)) imply bb== false) &amp;&amp; 
(bb== false imply ((lenH &gt;= Max_Queue_Size and High_Risk[p]==true)
or (lenL &gt;= Max_Queue_Size and High_Risk[p]== false)))</label>
			<label kind="synchronisation" x="-47433" y="-47289">LQ[p]!</label>
			<label kind="assignment" x="-47565" y="-47308">Perm_Given[p]:= true,
LQ_per[p]:=bb</label>
			<nail x="-47373" y="-47212"/>
			<nail x="-47421" y="-47236"/>
			<nail x="-47349" y="-47292"/>
			<nail x="-47301" y="-47204"/>
		</transition>
		<transition>
			<source ref="id25"/>
			<target ref="id25"/>
			<label kind="select" x="-47189" y="-47244">p:id_t</label>
			<label kind="synchronisation" x="-47125" y="-47260">ELR_HPQ[p]?</label>
			<nail x="-47125" y="-47204"/>
			<nail x="-47181" y="-47284"/>
			<nail x="-47229" y="-47220"/>
		</transition>
		<transition>
			<source ref="id25"/>
			<target ref="id25"/>
			<label kind="select" x="-47165" y="-47172">p:id_t</label>
			<label kind="synchronisation" x="-47093" y="-47156">ELR_LPQ[p]?</label>
			<nail x="-47133" y="-47116"/>
			<nail x="-47117" y="-47116"/>
			<nail x="-47117" y="-47188"/>
		</transition>
		<transition>
			<source ref="id25"/>
			<target ref="id25"/>
			<label kind="select" x="-47325" y="-47052">p:id_t</label>
			<label kind="guard" x="-47421" y="-47004">Gate_asn[p] == false &amp;&amp;
Runway_busy== true</label>
			<label kind="synchronisation" x="-47341" y="-47020">GG[p]!</label>
			<label kind="assignment" x="-47405" y="-46964">Gate_asn[p]:= true</label>
			<nail x="-47357" y="-47036"/>
			<nail x="-47277" y="-47020"/>
		</transition>
	</template>
	<template>
		<name x="5" y="5">M3_Planes</name>
		<parameter>const id_t id</parameter>
		<declaration>// Place local declarations here.
clock x;

    
void enHPqueue(id_t element)
{
   HPqueue [lenH++]=element;
 }

 void enLPqueue(id_t element)
 {
   LPqueue [lenL++]=element;
  }
//++++++++++++++++++++++++++++++++++++++++++++++++++++++++
void deHPqueue()   // normal dequeue happens from High priority Queue
{
        int i = 0;
        --lenH;
        while (i &lt; lenH)
        {
                HPqueue[i] = HPqueue[i + 1];
                i++;
        }
        HPqueue[i] = 0;
}
void deLPqueue()    // normal dequeue happens from Low priority Queue
{
        int i = 0;
        --lenL;
        while (i &lt; lenL)
        {
                LPqueue[i] = LPqueue[i + 1];
                i++;
        }
        LPqueue[i] = 0;
}


 //    ***********************   High Priority Queue  removing element in emergancy situation******************


id_t Em_deHPqu_idx(id_t plane )   // dequeue happens when plane send emergancy landing while it is in queue, we want to know its position in the queue ### ELR_HPQ ###
{       
        int i=0;

      while (HPqueue[i] != plane)
  {
        i++;
       
   }
    return i;
   }


void Em_deHPqueue(id_t i )   // dequeue happens when plane send emergancy landing while it is in queue we remove the plane based on its position in the queue ### ELR_HPQ ###
{       
    
        --lenH;
        while (i &lt; lenH)
        {
                HPqueue[i] = HPqueue[i + 1];
                i++;
        }
        HPqueue[i] = 0;
}
   
//    ***********************   Low Priority Queue  removing element in emergancy situation******************


id_t Em_deLPqu_idx(id_t plane )   // dequeue happens when plane send emergancy landing while it is in queue but we want to know its position in the queue ### ELR_HPQ ###
{       
     int i=0;

      while (LPqueue[i] != plane)
  {
         i++;
   }
    return i;
   }

void Em_deLPqueue(id_t i)  //  dequeue happens when plane send emergancy landing while it is in queue we remove the plane based on its position in the queue ### ELR_LPQ ###
{
   
       --lenL;
        while (i &lt; lenL)
       
        {
                LPqueue[i] = LPqueue[i + 1];
                i++;
                
        }
        LPqueue[i] = 0;
} 





</declaration>
		<location id="id26" x="340" y="-289">
			<name x="314" y="-323">High_PQ</name>
			<label kind="invariant" x="323" y="-281">x&lt;=10</label>
		</location>
		<location id="id27" x="-68" y="-42">
			<name x="-187" y="-50">Leaving_Airport</name>
		</location>
		<location id="id28" x="408" y="110">
			<name x="340" y="93">At_Gate</name>
		</location>
		<location id="id29" x="-68" y="85">
			<name x="-144" y="51">Waiting_EmergLand</name>
			<urgent/>
		</location>
		<location id="id30" x="348" y="-34">
			<name x="374" y="-51">Landing_Runway</name>
			<committed/>
		</location>
		<location id="id31" x="229" y="-161">
			<name x="204" y="-204">Low_PQ</name>
			<label kind="invariant" x="212" y="-144">x&lt;=20</label>
		</location>
		<location id="id32" x="-68" y="-161">
			<name x="-170" y="-204">Waiting_L_Permission</name>
			<urgent/>
		</location>
		<location id="id33" x="-374" y="-161">
			<name x="-391" y="-195">In_Air</name>
			<label kind="invariant" x="-399" y="-144">x &lt;=20</label>
		</location>
		<init ref="id33"/>
		<transition>
			<source ref="id31"/>
			<target ref="id31"/>
			<label kind="guard" x="238" y="-255">fuel[id] == medium &amp;&amp;
x &gt;= 10 &amp;&amp; x &lt;= 20</label>
			<label kind="assignment" x="263" y="-221">fuel[id]:= low, x:=0</label>
			<nail x="280" y="-195"/>
			<nail x="238" y="-212"/>
			<nail x="237" y="-177"/>
		</transition>
		<transition>
			<source ref="id31"/>
			<target ref="id31"/>
			<label kind="guard" x="93" y="-271">fuel[id] == high &amp;&amp;
x &gt;= 10 &amp;&amp; x &lt;= 15</label>
			<label kind="assignment" x="59" y="-238">fuel[id]:= medium, x:=0</label>
			<nail x="187" y="-212"/>
			<nail x="229" y="-229"/>
		</transition>
		<transition>
			<source ref="id26"/>
			<target ref="id26"/>
			<label kind="synchronisation" x="416" y="-323">HPQ_LP[id]?</label>
			<label kind="assignment" x="416" y="-306">x:=0</label>
			<nail x="408" y="-314"/>
			<nail x="416" y="-280"/>
		</transition>
		<transition>
			<source ref="id31"/>
			<target ref="id31"/>
			<label kind="synchronisation" x="289" y="-195">LPQ_LP[id]?</label>
			<label kind="assignment" x="306" y="-178">x:=0</label>
			<nail x="289" y="-161"/>
			<nail x="280" y="-187"/>
		</transition>
		<transition>
			<source ref="id26"/>
			<target ref="id26"/>
			<label kind="guard" x="331" y="-399">fuel[id] == medium &amp;&amp;
x &gt;= 5 &amp;&amp; x &lt;= 10</label>
			<label kind="assignment" x="340" y="-365">fuel[id]:= low, x:=0</label>
			<nail x="399" y="-323"/>
			<nail x="348" y="-348"/>
		</transition>
		<transition>
			<source ref="id26"/>
			<target ref="id30"/>
			<label kind="guard" x="467" y="-229">Runway_busy &amp;&amp;
Lan_per[id]</label>
			<label kind="assignment" x="476" y="-153">LQ_per[id]:=false,
deHPqueue()</label>
			<nail x="374" y="-280"/>
			<nail x="467" y="-212"/>
			<nail x="467" y="-76"/>
		</transition>
		<transition>
			<source ref="id32"/>
			<target ref="id31"/>
			<label kind="guard" x="-8" y="-204">LQ_per[id] &amp;&amp; Perm_Given[id]
&amp;&amp; fuel[id] == high &amp;&amp; 
not High_Risk[id]</label>
			<label kind="assignment" x="-34" y="-153">Perm_Given[id]:=false ,
enLPqueue(id), x:=0</label>
			<nail x="88" y="-160"/>
			<nail x="208" y="-160"/>
		</transition>
		<transition>
			<source ref="id26"/>
			<target ref="id29"/>
			<label kind="select" x="-127" y="-391">HP_index:id_t</label>
			<label kind="guard" x="-8" y="-399">not Lan_per[id] &amp;&amp; fuel[id] == low &amp;&amp;
HP_index == Em_deHPqu_idx(id)</label>
			<label kind="synchronisation" x="-314" y="-382">ELR_HPQ[id]!</label>
			<label kind="assignment" x="-399" y="-357">Em_deHPqueue(HP_index), x:=0</label>
			<nail x="272" y="-348"/>
			<nail x="248" y="-361"/>
			<nail x="-248" y="-361"/>
			<nail x="-312" y="-361"/>
			<nail x="-408" y="-361"/>
			<nail x="-408" y="102"/>
			<nail x="-314" y="102"/>
			<nail x="-127" y="102"/>
		</transition>
		<transition>
			<source ref="id32"/>
			<target ref="id26"/>
			<label kind="guard" x="-25" y="-340">LQ_per[id] 
&amp;&amp; Perm_Given[id]
&amp;&amp; fuel[id] != high
&amp;&amp; High_Risk[id]</label>
			<label kind="assignment" x="127" y="-323">Perm_Given[id]:=false ,
enHPqueue(id), x:=0</label>
			<nail x="16" y="-264"/>
			<nail x="32" y="-280"/>
			<nail x="48" y="-280"/>
			<nail x="59" y="-280"/>
		</transition>
		<transition>
			<source ref="id32"/>
			<target ref="id27"/>
			<label kind="guard" x="-221" y="-110">not LQ_per[id] &amp;&amp; 
Perm_Given[id]</label>
			<label kind="assignment" x="-229" y="-76">Perm_Given[id]:= false</label>
			<nail x="-68" y="-136"/>
		</transition>
		<transition>
			<source ref="id30"/>
			<target ref="id28"/>
			<label kind="guard" x="450" y="-17">Gate_asn[id] &amp;&amp;
Runway_busy &amp;&amp;
Lan_per[id]</label>
			<label kind="assignment" x="442" y="42">Gate_asn[id]:=false ,
Runway_busy:=false,
Lan_per[id]:=false</label>
			<nail x="442" y="-8"/>
			<nail x="442" y="76"/>
		</transition>
		<transition>
			<source ref="id30"/>
			<target ref="id28"/>
			<label kind="guard" x="195" y="-17">Gate_asn[id] &amp;&amp; Runway_busy 
&amp;&amp; Elan_per[id] &amp;&amp; Emergency_Prog</label>
			<label kind="assignment" x="263" y="17">Gate_asn[id]:=false, 
Runway_busy:=false,
Elan_per[id]:=false, 
Emergency_Prog:=false</label>
			<nail x="348" y="25"/>
		</transition>
		<transition>
			<source ref="id30"/>
			<target ref="id30"/>
			<label kind="synchronisation" x="221" y="-51">GG[id]?</label>
			<nail x="272" y="-59"/>
			<nail x="272" y="-25"/>
			<nail x="331" y="-34"/>
		</transition>
		<transition>
			<source ref="id29"/>
			<target ref="id29"/>
			<label kind="synchronisation" x="-144" y="102">ELP[id]?</label>
			<nail x="-42" y="119"/>
			<nail x="-93" y="119"/>
		</transition>
		<transition>
			<source ref="id32"/>
			<target ref="id32"/>
			<label kind="synchronisation" x="-127" y="-263">LQ[id]?</label>
			<nail x="-119" y="-238"/>
			<nail x="-59" y="-246"/>
		</transition>
		<transition>
			<source ref="id29"/>
			<target ref="id27"/>
			<label kind="guard" x="-195" y="-17">not Elan_per[id]&amp;&amp;
Perm_Given[id]</label>
			<label kind="assignment" x="-212" y="34">Perm_Given[id]:= false</label>
		</transition>
		<transition>
			<source ref="id31"/>
			<target ref="id29"/>
			<label kind="select" x="110" y="-119">LP_index:id_t</label>
			<label kind="guard" x="8" y="-102">not Lan_per[id] &amp;&amp;
fuel[id]== low &amp;&amp; 
LP_index==Em_deLPqu_idx(id)</label>
			<label kind="synchronisation" x="25" y="-42">ELR_LPQ[id]!</label>
			<label kind="assignment" x="-25" y="-25">Em_deLPqueue(LP_index)</label>
			<nail x="212" y="-153"/>
		</transition>
		<transition>
			<source ref="id33"/>
			<target ref="id29"/>
			<label kind="synchronisation" x="-374" y="-34">ELR[id]!</label>
			<nail x="-374" y="-102"/>
			<nail x="-374" y="85"/>
			<nail x="-119" y="85"/>
		</transition>
		<transition>
			<source ref="id29"/>
			<target ref="id30"/>
			<label kind="guard" x="34" y="17">Perm_Given[id] &amp;&amp; 
Runway_busy &amp;&amp;
Elan_per[id] &amp;&amp; 
Emergency_Prog</label>
			<label kind="assignment" x="34" y="93">Perm_Given[id]:=false</label>
			<nail x="-51" y="93"/>
			<nail x="238" y="51"/>
		</transition>
		<transition>
			<source ref="id31"/>
			<target ref="id30"/>
			<label kind="guard" x="280" y="-144">Runway_busy &amp;&amp;
Lan_per[id]</label>
			<label kind="assignment" x="314" y="-102">LQ_per[id]:=false,
deLPqueue()</label>
			<nail x="246" y="-153"/>
		</transition>
		<transition>
			<source ref="id33"/>
			<target ref="id32"/>
			<label kind="select" x="-340" y="-238">fp:fstate, br:boo</label>
			<label kind="guard" x="-348" y="-221">br == false imply fp == 2 &amp;&amp;
 fp == 2 imply br == false</label>
			<label kind="synchronisation" x="-331" y="-187">LR[id]!</label>
			<label kind="assignment" x="-348" y="-161">High_Risk[id]:=((br== false imply fp==2)
&amp;&amp; (fp==2 imply br== false)? false:true), 
fuel[id]:=fp</label>
		</transition>
	</template>
	<template>
		<name>M3_Controller</name>
		<declaration>id_t front_HP(){  // To have access to the first element in the queue

 return HPqueue [0];

}
id_t front_LP(){  // To have access to the first element in the queue

 return LPqueue [0];

}










</declaration>
		<location id="id34" x="-17608" y="-4272">
		</location>
		<init ref="id34"/>
		<transition>
			<source ref="id34"/>
			<target ref="id34"/>
			<label kind="select" x="-17552" y="-4250">p:id_t</label>
			<label kind="synchronisation" x="-17493" y="-4258">ELR[p]?</label>
			<nail x="-17501" y="-4267"/>
			<nail x="-17510" y="-4224"/>
		</transition>
		<transition>
			<source ref="id34"/>
			<target ref="id34"/>
			<label kind="select" x="-17722" y="-4292">p:id_t</label>
			<label kind="guard" x="-18003" y="-4335">not Runway_busy &amp;&amp;
not Lan_per[p] &amp;&amp; not Emergency_Prog &amp;&amp; 
(counter&lt;=3 or lenL==0) &amp;&amp; p==front_HP()</label>
			<label kind="synchronisation" x="-17731" y="-4275">HPQ_LP[p]!</label>
			<label kind="assignment" x="-18003" y="-4267">Runway_busy:=true, Lan_per[p]:= true,
counter++</label>
			<nail x="-17731" y="-4241"/>
			<nail x="-17731" y="-4301"/>
		</transition>
		<transition>
			<source ref="id34"/>
			<target ref="id34"/>
			<label kind="select" x="-17697" y="-4250">p:id_t</label>
			<label kind="guard" x="-17994" y="-4224">not Runway_busy &amp;&amp; not Lan_per[p] &amp;&amp; 
not Emergency_Prog &amp;&amp;
(counter&gt;=3 or lenH==0)&amp;&amp; p== front_LP()</label>
			<label kind="synchronisation" x="-17722" y="-4233">LPQ_LP[p]!</label>
			<label kind="assignment" x="-17986" y="-4156">Runway_busy:=true, Lan_per[p]:= true,
counter:=0</label>
			<nail x="-17697" y="-4182"/>
			<nail x="-17731" y="-4233"/>
		</transition>
		<transition>
			<source ref="id34"/>
			<target ref="id34"/>
			<label kind="select" x="-17620" y="-4369">p:id_t</label>
			<label kind="synchronisation" x="-17620" y="-4386">LR[p]?</label>
			<nail x="-17569" y="-4369"/>
			<nail x="-17646" y="-4369"/>
		</transition>
		<transition>
			<source ref="id34"/>
			<target ref="id34"/>
			<label kind="select" x="-17578" y="-4224">p:id_t,
bb:boo</label>
			<label kind="guard" x="-17501" y="-4216">not Runway_busy&amp;&amp;
not Elan_per[p] 
&amp;&amp; not Perm_Given[p] &amp;&amp; 
not(bb==Emergency_Prog)</label>
			<label kind="synchronisation" x="-17561" y="-4182">ELP[p]!</label>
			<label kind="assignment" x="-17569" y="-4139">Elan_per[p]:= bb, Perm_Given[p]:=true,
Emergency_Prog:= true, Runway_busy:=true</label>
			<nail x="-17578" y="-4173"/>
			<nail x="-17518" y="-4207"/>
		</transition>
		<transition>
			<source ref="id34"/>
			<target ref="id34"/>
			<label kind="select" x="-17706" y="-4361">p:id_t,
bb:boo</label>
			<label kind="guard" x="-18045" y="-4505">not Perm_Given[p] &amp;&amp; (Emergency_Prog imply bb==false) &amp;&amp; (((lenH &gt;= Max_Queue_Size and High_Risk[p])
or (lenL &gt;= Max_Queue_Size and not High_Risk[p])) imply bb==false) &amp;&amp; 
(bb== false imply ((lenH &gt;= Max_Queue_Size and High_Risk[p])
or (lenL &gt;= Max_Queue_Size and not High_Risk[p]))) &amp;&amp; (((lenH &gt;= Max_Queue_Size and fuel[p]!=high) 
or ( lenL &gt;= Max_Queue_Size and fuel[p]==high)) imply 
bb==false) &amp;&amp;  (bb==false imply ((lenH &gt;= Max_Queue_Size and fuel[p]!=high) 
or ( lenL &gt;= Max_Queue_Size and fuel[p]==high)))</label>
			<label kind="synchronisation" x="-17697" y="-4326">LQ[p]!</label>
			<label kind="assignment" x="-17850" y="-4369">Perm_Given[p]:= true,
LQ_per[p]:=bb</label>
			<nail x="-17722" y="-4318"/>
			<nail x="-17680" y="-4369"/>
		</transition>
		<transition>
			<source ref="id34"/>
			<target ref="id34"/>
			<label kind="select" x="-17569" y="-4335">p:id_t</label>
			<label kind="synchronisation" x="-17518" y="-4352">ELR_HPQ[p]?</label>
			<nail x="-17510" y="-4326"/>
			<nail x="-17561" y="-4360"/>
		</transition>
		<transition>
			<source ref="id34"/>
			<target ref="id34"/>
			<label kind="select" x="-17552" y="-4292">p:id_t</label>
			<label kind="synchronisation" x="-17493" y="-4301">ELR_LPQ[p]?</label>
			<nail x="-17501" y="-4275"/>
			<nail x="-17510" y="-4318"/>
		</transition>
		<transition>
			<source ref="id34"/>
			<target ref="id34"/>
			<label kind="select" x="-17646" y="-4216">p:id_t</label>
			<label kind="guard" x="-17697" y="-4165">not Gate_asn[p] 
&amp;&amp; Runway_busy</label>
			<label kind="synchronisation" x="-17654" y="-4199">GG[p]!</label>
			<label kind="assignment" x="-17714" y="-4122">Gate_asn[p]:= true</label>
			<nail x="-17671" y="-4182"/>
			<nail x="-17603" y="-4165"/>
		</transition>
	</template>
	<system>// Place template instantiations here.

// List one or more processes to be composed into a system.
system M3_Planes, M3_Controller;</system>
	<queries>
		<query>
			<formula>A&lt;&gt; forall (i : int [0,1]) (M3_Planes(i).At_Gate || M3_Planes(i).Leaving_Airport) &amp;&amp; Gclk &lt;= 120
			</formula>
			<comment>All planes eventually either get to gate or leave the airport
			</comment>
		</query>
	</queries>
</nta>
